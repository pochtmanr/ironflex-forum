'use client'

import { useState } from 'react';
import Link from 'next/link';

interface FAQItem {
  question: string;
  answer: string;
}

interface FAQSection {
  title: string;
  items: FAQItem[];
}

export default function FAQ() {
  const [openItems, setOpenItems] = useState<string[]>([]);

  const toggleItem = (key: string) => {
    setOpenItems(prev =>
      prev.includes(key)
        ? prev.filter(k => k !== key)
        : [...prev, key]
    );
  };

  const sections: FAQSection[] = [
    {
      title: "Регистрация и вход",
      items: [
        {
          question: "Как зарегистрироваться на форуме?",
          answer: "Нажмите на кнопку «Регистрация» в правом верхнем углу страницы, заполните необходимые поля (имя пользователя, email, пароль) и подтвердите регистрацию по ссылке, отправленной на вашу электронную почту."
        },
        {
          question: "Что делать, если забыл пароль?",
          answer: "На странице входа нажмите на ссылку «Забыли пароль?» и введите email, указанный при регистрации. Вы получите письмо с инструкцией по восстановлению доступа."
        },
        {
          question: "Можно ли изменить имя пользователя после регистрации?",
          answer: "Имя пользователя задаётся при регистрации. Для его изменения обратитесь к администрации форума через контактный email."
        },
        {
          question: "Как редактировать свой профиль?",
          answer: "После входа в систему перейдите в свой профиль, нажав на имя пользователя. Там вы сможете изменить аватар, описание и контактную информацию."
        },
      ],
    },
    {
      title: "Публикация и правила",
      items: [
        {
          question: "Как создать новую тему?",
          answer: "Зарегистрированные пользователи могут создавать темы, нажав на кнопку «Создать тему» на главной странице или в любой категории форума. Выберите подходящую категорию и заполните заголовок и текст."
        },
        {
          question: "Можно ли прикреплять файлы к сообщениям?",
          answer: "Да, к сообщениям можно прикреплять изображения. Поддерживаются распространённые форматы: JPG, PNG, GIF. Размер файла ограничен."
        },
        {
          question: "Что запрещено публиковать на форуме?",
          answer: "Запрещены: спам, оскорбления, дискриминация, нарушение авторских прав, размещение незаконного контента, персональных данных третьих лиц, а также выдача личного мнения за медицинские рекомендации. Подробные правила изложены на странице «Администрация»."
        },
        {
          question: "Можно ли редактировать или удалять свои сообщения?",
          answer: "Вы можете редактировать свои сообщения. Удаление сообщений возможно в ограниченных случаях. Если вам нужно удалить публикацию, обратитесь к модератору."
        },
      ],
    },
    {
      title: "Общение на форуме",
      items: [
        {
          question: "Что такое «Разговорный Хаб»?",
          answer: "Разговорный Хаб — это раздел для свободного общения на любые темы, не обязательно связанные со спортом или здоровьем. Здесь действуют общие правила форума, но тематика обсуждений не ограничена."
        },
        {
          question: "Как работает система оценок (лайков)?",
          answer: "Пользователи могут оценивать сообщения других участников. Положительные оценки отражают полезность и качество сообщения для сообщества."
        },
        {
          question: "Как найти интересующую тему?",
          answer: "Просматривайте категории форума на главной странице. Темы в каждой категории можно сортировать по дате активности."
        },
        {
          question: "Можно ли использовать форум с мобильного устройства?",
          answer: "Да, форум адаптирован для мобильных устройств и корректно работает на смартфонах и планшетах."
        },
      ],
    },
    {
      title: "Модерация и ограничения",
      items: [
        {
          question: "За что могут вынести предупреждение или заблокировать?",
          answer: "Предупреждения и блокировки выносятся за нарушение правил форума: оскорбления, спам, размещение запрещённого контента, систематическое нарушение норм общения. Решение принимается модераторами или администрацией."
        },
        {
          question: "Что делать, если моё сообщение было удалено?",
          answer: "Если ваше сообщение было удалено, вероятно, оно нарушало правила форума. Ознакомьтесь с правилами на странице «Администрация». Если вы считаете, что удаление было ошибочным, свяжитесь с администрацией."
        },
        {
          question: "Можно ли обжаловать блокировку?",
          answer: "Да, вы можете написать на контактный email администрации с описанием ситуации. Обращения рассматриваются в индивидуальном порядке."
        },
        {
          question: "Как пожаловаться на сообщение другого пользователя?",
          answer: "Используйте кнопку жалобы (флажок) рядом с сообщением, нарушающим правила. Модераторы рассмотрят обращение и примут соответствующие меры."
        },
      ],
    },
    {
      title: "Данные и конфиденциальность",
      items: [
        {
          question: "Какие данные собирает форум?",
          answer: "При регистрации собираются: имя пользователя, адрес электронной почты и пароль (хранится в зашифрованном виде). Дополнительная информация в профиле заполняется по желанию пользователя."
        },
        {
          question: "Кто может видеть мой профиль?",
          answer: "Профиль пользователя, включая имя и аватар, виден другим зарегистрированным участникам. Адрес электронной почты не отображается публично."
        },
        {
          question: "Как удалить свой аккаунт?",
          answer: "Для удаления аккаунта обратитесь к администрации по контактному email. Учтите, что опубликованные сообщения могут быть сохранены в обезличенном виде."
        },
        {
          question: "Используются ли файлы cookie?",
          answer: "Форум использует технические файлы cookie, необходимые для работы сайта (авторизация, сохранение сессии). Подробнее — в Политике конфиденциальности."
        },
      ],
    },
  ];

  return (
    <div className="max-w-4xl mx-auto px-4 py-8">
      <h1 className="text-3xl font-bold text-gray-900 mb-8">Часто задаваемые вопросы</h1>

      <div className="space-y-8">
        {sections.map((section, sIdx) => (
          <div key={sIdx}>
            <h2 className="text-xl font-semibold text-gray-800 mb-4">{section.title}</h2>
            <div className="space-y-3">
              {section.items.map((faq, fIdx) => {
                const key = `${sIdx}-${fIdx}`;
                return (
                  <div key={key} className="border border-gray-200 rounded-lg">
                    <button
                      onClick={() => toggleItem(key)}
                      className="w-full px-6 py-4 text-left flex justify-between items-center hover:bg-gray-50 transition-colors"
                    >
                      <span className="font-medium text-gray-900">{faq.question}</span>
                      <svg
                        className={`w-5 h-5 text-gray-500 transition-transform flex-shrink-0 ml-2 ${
                          openItems.includes(key) ? 'rotate-180' : ''
                        }`}
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                      </svg>
                    </button>
                    {openItems.includes(key) && (
                      <div className="px-6 pb-4">
                        <p className="text-gray-700 leading-relaxed">{faq.answer}</p>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          </div>
        ))}
      </div>

      <div className="mt-12 bg-blue-50 p-6 rounded-lg">
        <h2 className="text-xl font-semibold text-gray-800 mb-3">Не нашли ответ на свой вопрос?</h2>
        <p className="text-gray-700 mb-4">
          Если у вас есть другие вопросы, обратитесь к администрации:
        </p>
        <div className="flex flex-col sm:flex-row gap-4">
          <a
            href="mailto:info@tarnovsky.ru.kz"
            className="px-6 py-3 bg-blue-600 text-white hover:bg-blue-700 transition-colors font-medium text-center"
          >
            Написать нам
          </a>
          <Link
            href="/administration"
            className="px-6 py-3 border border-blue-600 text-blue-600 hover:bg-blue-50 transition-colors font-medium text-center"
          >
            Администрация
          </Link>
        </div>
      </div>
    </div>
  );
}
